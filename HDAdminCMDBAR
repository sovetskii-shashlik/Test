local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

local localPlayer = Players.LocalPlayer
local isOnMobile = UserInputService.TouchEnabled

local clients = {
    "HDAdminClient",
    "HDAdminHDClient"
}

local currentClient = clients[1]

local protections = {
    blur = {enabled = false, check = function()
        return workspace.Camera:FindFirstChild("Blur")
    end, command = "unblur"},
    
    jail = {enabled = false, check = function()
        return workspace:FindFirstChild(localPlayer.Name .. "'s JailCell")
    end, command = "unjail"},
    
    ice = {enabled = false, check = function()
        return workspace:FindFirstChild(localPlayer.Name .. "'s FreezeBlock")
    end, command = "unice"},
    
    freeze = {enabled = false, check = function()
        if not localPlayer.Character then return false end
        for _, part in ipairs(localPlayer.Character:GetChildren()) do
            if part:IsA("BasePart") and part.Anchored then
                return true
            end
        end
        return false
    end, command = "unice"},
    
    ff = {enabled = false, check = function()
        if not localPlayer.Character then return false end
        return not localPlayer.Character:FindFirstChild("HDAdminForceField")
    end, command = "ff me"},
    
    mute = {enabled = false, check = function()
        return not localPlayer:FindFirstChild("PlayerGui") or not localPlayer.PlayerGui:FindFirstChild("Chat")
    end, command = "unmute"}
}

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "HDAdminCmdBar"
screenGui.Parent = game:GetService("CoreGui")
screenGui.ResetOnSpawn = false

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 300, 0, 180)
frame.Position = UDim2.new(0.5, -150, 0.1, 0)
frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
frame.BackgroundTransparency = 0.2
frame.Parent = screenGui

frame.Active = true
frame.Draggable = true

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 8)
UICorner.Parent = frame

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 25)
title.Position = UDim2.new(0, 0, 0, 2)
title.BackgroundTransparency = 1
title.Text = "HD Admin Command Bar"
title.TextColor3 = Color3.new(1, 1, 1)
title.Font = Enum.Font.GothamBold
title.TextSize = 16
title.Parent = frame

local textGradient = Instance.new("UIGradient", title)
textGradient.Rotation = 90

local function lerpColor(color1, color2, alpha)
    return Color3.new(
        color1.R + (color2.R - color1.R) * alpha,
        color1.G + (color2.G - color1.G) * alpha,
        color1.B + (color2.B - color1.B) * alpha
    )
end

local function animateTextGradient()
    local duration = 2
    local steps = 60
    local stepTime = duration / steps
    local color1 = Color3.fromRGB(255, 100, 100)
    local color2 = Color3.fromRGB(100, 100, 255)

    while true do
        for i = 0, steps do
            local alpha = i / steps
            textGradient.Color = ColorSequence.new({
                ColorSequenceKeypoint.new(0, lerpColor(color1, color2, alpha)),
                ColorSequenceKeypoint.new(1, lerpColor(color2, color1, alpha))
            })
            task.wait(stepTime)
        end

        for i = 0, steps do
            local alpha = i / steps
            textGradient.Color = ColorSequence.new({
                ColorSequenceKeypoint.new(0, lerpColor(color2, color1, alpha)),
                ColorSequenceKeypoint.new(1, lerpColor(color1, color2, alpha))
            })
            task.wait(stepTime)
        end
    end
end

task.spawn(animateTextGradient)

local prefixLabel = Instance.new("TextLabel")
prefixLabel.Size = UDim2.new(0, 40, 0, 18)
prefixLabel.Position = UDim2.new(0.05, 0, 0, 30)
prefixLabel.BackgroundTransparency = 1
prefixLabel.Text = "Prefix:"
prefixLabel.TextColor3 = Color3.new(1, 1, 1)
prefixLabel.Font = Enum.Font.Gotham
prefixLabel.TextSize = 12
prefixLabel.TextXAlignment = Enum.TextXAlignment.Left
prefixLabel.Parent = frame

local prefixBox = Instance.new("TextBox")
prefixBox.Size = UDim2.new(0, 30, 0, 20)
prefixBox.Position = UDim2.new(0.05, 45, 0, 30)
prefixBox.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
prefixBox.Text = ";"
prefixBox.PlaceholderText = ""
prefixBox.TextColor3 = Color3.new(1, 1, 1)
prefixBox.ClearTextOnFocus = false
prefixBox.TextSize = 12
prefixBox.Parent = frame

local prefixCorner = Instance.new("UICorner")
prefixCorner.CornerRadius = UDim.new(0, 4)
prefixCorner.Parent = prefixBox

local clientButton = Instance.new("TextButton")
clientButton.Size = UDim2.new(0, 100, 0, 20)
clientButton.Position = UDim2.new(0.55, 0, 0, 30)
clientButton.BackgroundColor3 = Color3.fromRGB(60, 60, 120)
clientButton.Text = currentClient
clientButton.TextColor3 = Color3.new(1, 1, 1)
clientButton.Font = Enum.Font.Gotham
clientButton.TextSize = 10
clientButton.Parent = frame

local clientCorner = Instance.new("UICorner")
clientCorner.CornerRadius = UDim.new(0, 4)
clientCorner.Parent = clientButton

local protectionsButton = Instance.new("TextButton")
protectionsButton.Size = UDim2.new(0, 100, 0, 20)
protectionsButton.Position = UDim2.new(0.55, 0, 0, 55)
protectionsButton.BackgroundColor3 = Color3.fromRGB(60, 60, 120)
protectionsButton.Text = "Protections: OFF"
protectionsButton.TextColor3 = Color3.new(1, 1, 1)
protectionsButton.Font = Enum.Font.Gotham
protectionsButton.TextSize = 10
protectionsButton.Parent = frame

local protectionsCorner = Instance.new("UICorner")
protectionsCorner.CornerRadius = UDim.new(0, 4)
protectionsCorner.Parent = protectionsButton

local commandLabel = Instance.new("TextLabel")
commandLabel.Size = UDim2.new(0, 65, 0, 18)
commandLabel.Position = UDim2.new(0.05, 0, 0, 80)
commandLabel.BackgroundTransparency = 1
commandLabel.Text = "Command:"
commandLabel.TextColor3 = Color3.new(1, 1, 1)
commandLabel.Font = Enum.Font.Gotham
commandLabel.TextSize = 12
commandLabel.TextXAlignment = Enum.TextXAlignment.Left
commandLabel.Parent = frame

local commandBox = Instance.new("TextBox")
commandBox.Size = UDim2.new(0.9, 0, 0, 25)
commandBox.Position = UDim2.new(0.05, 0, 0, 100)
commandBox.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
commandBox.Text = ""
commandBox.PlaceholderText = "explode player1 ;kill player2"
commandBox.TextColor3 = Color3.new(1, 1, 1)
commandBox.ClearTextOnFocus = false
commandBox.TextSize = 12
commandBox.Font = Enum.Font.Code
commandBox.TextXAlignment = Enum.TextXAlignment.Left
commandBox.TextWrapped = false
commandBox.ClipsDescendants = true
commandBox.Parent = frame

local padding = Instance.new("UIPadding")
padding.PaddingLeft = UDim.new(0, 5)
padding.PaddingRight = UDim.new(0, 5)
padding.Parent = commandBox

local commandCorner = Instance.new("UICorner")
commandCorner.CornerRadius = UDim.new(0, 6)
commandCorner.Parent = commandBox

local executeBtn = Instance.new("TextButton")
executeBtn.Size = UDim2.new(0.9, 0, 0, 28)
executeBtn.Position = UDim2.new(0.05, 0, 0, 130)
executeBtn.BackgroundColor3 = Color3.fromRGB(60, 120, 60)
executeBtn.Text = "EXECUTE"
executeBtn.TextColor3 = Color3.new(1, 1, 1)
executeBtn.Font = Enum.Font.GothamBold
executeBtn.TextSize = 14
executeBtn.Parent = frame

local btnCorner = Instance.new("UICorner")
btnCorner.CornerRadius = UDim.new(0, 6)
btnCorner.Parent = executeBtn

local statusLabel = Instance.new("TextLabel")
statusLabel.Size = UDim2.new(1, 0, 0, 15)
statusLabel.Position = UDim2.new(0, 0, 0, 160)
statusLabel.BackgroundTransparency = 1
statusLabel.Text = "Status: Ready"
statusLabel.TextColor3 = Color3.new(1, 1, 1)
statusLabel.Font = Enum.Font.Gotham
statusLabel.TextSize = 10
statusLabel.Parent = frame

local borderFrame = Instance.new("Frame")
borderFrame.Size = frame.Size
borderFrame.Position = frame.Position
borderFrame.BackgroundTransparency = 1
borderFrame.AnchorPoint = frame.AnchorPoint
borderFrame.ZIndex = frame.ZIndex - 1
borderFrame.Parent = screenGui

local borderCorner = frame.UICorner:Clone()
borderCorner.Parent = borderFrame

local borderStroke = Instance.new("UIStroke")
borderStroke.Thickness = 2
borderStroke.Color = Color3.fromRGB(100, 100, 255)
borderStroke.LineJoinMode = Enum.LineJoinMode.Round
borderStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Contextual
borderStroke.Parent = borderFrame

frame:GetPropertyChangedSignal("Position"):Connect(function()
    borderFrame.Position = frame.Position
end)

frame:GetPropertyChangedSignal("Size"):Connect(function()
    borderFrame.Size = frame.Size
end)

local clientSelectionFrame = Instance.new("Frame")
clientSelectionFrame.Size = UDim2.new(0, 120, 0, 0)
clientSelectionFrame.Position = UDim2.new(0, clientButton.AbsolutePosition.X, 0, clientButton.AbsolutePosition.Y + 25)
clientSelectionFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
clientSelectionFrame.BorderSizePixel = 0
clientSelectionFrame.Visible = false
clientSelectionFrame.Parent = screenGui

local clientSelectionCorner = Instance.new("UICorner")
clientSelectionCorner.CornerRadius = UDim.new(0, 4)
clientSelectionCorner.Parent = clientSelectionFrame

local clientSelectionLayout = Instance.new("UIListLayout")
clientSelectionLayout.Parent = clientSelectionFrame

local function updateClientSelectionSize()
    clientSelectionFrame.Size = UDim2.new(0, 120, 0, #clients * 25)
end

local function createClientOption(clientName)
    local optionButton = Instance.new("TextButton")
    optionButton.Size = UDim2.new(1, 0, 0, 25)
    optionButton.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
    optionButton.Text = clientName
    optionButton.TextColor3 = Color3.new(1, 1, 1)
    optionButton.Font = Enum.Font.Gotham
    optionButton.TextSize = 11
    optionButton.Parent = clientSelectionFrame

    optionButton.MouseButton1Click:Connect(function()
        currentClient = clientName
        clientButton.Text = currentClient
        clientSelectionFrame.Visible = false
    end)

    optionButton.MouseEnter:Connect(function()
        TweenService:Create(optionButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 80, 100)}):Play()
    end)

    optionButton.MouseLeave:Connect(function()
        TweenService:Create(optionButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 80)}):Play()
    end)
end

for _, clientName in ipairs(clients) do
    createClientOption(clientName)
end

updateClientSelectionSize()

local protectionsFrame = Instance.new("Frame")
protectionsFrame.Size = UDim2.new(0, 120, 0, 0)
protectionsFrame.Position = UDim2.new(0, protectionsButton.AbsolutePosition.X, 0, protectionsButton.AbsolutePosition.Y + 25)
protectionsFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
protectionsFrame.BorderSizePixel = 0
protectionsFrame.Visible = false
protectionsFrame.Parent = screenGui

local protectionsCornerUI = Instance.new("UICorner")
protectionsCornerUI.CornerRadius = UDim.new(0, 4)
protectionsCornerUI.Parent = protectionsFrame

local protectionsLayout = Instance.new("UIListLayout")
protectionsLayout.Parent = protectionsFrame

local function updateProtectionsSize()
    protectionsFrame.Size = UDim2.new(0, 120, 0, #protections * 25)
end

local function createProtectionOption(protectionName, protectionData)
    local optionButton = Instance.new("TextButton")
    optionButton.Size = UDim2.new(1, 0, 0, 25)
    optionButton.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
    optionButton.Text = protectionName .. ": OFF"
    optionButton.TextColor3 = Color3.new(1, 1, 1)
    optionButton.Font = Enum.Font.Gotham
    optionButton.TextSize = 11
    optionButton.Parent = protectionsFrame

    optionButton.MouseButton1Click:Connect(function()
        protectionData.enabled = not protectionData.enabled
        optionButton.Text = protectionName .. ": " .. (protectionData.enabled and "ON" or "OFF")
        optionButton.BackgroundColor3 = protectionData.enabled and Color3.fromRGB(80, 120, 80) or Color3.fromRGB(60, 60, 80)
        
        local enabledCount = 0
        for _, prot in pairs(protections) do
            if prot.enabled then
                enabledCount = enabledCount + 1
            end
        end
        protectionsButton.Text = "Protections: " .. (enabledCount > 0 and "ON" or "OFF")
    end)

    optionButton.MouseEnter:Connect(function()
        TweenService:Create(optionButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 80, 100)}):Play()
    end)

    optionButton.MouseLeave:Connect(function()
        if not protectionData.enabled then
            TweenService:Create(optionButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 80)}):Play()
        end
    end)
end

for protectionName, protectionData in pairs(protections) do
    createProtectionOption(protectionName, protectionData)
end

updateProtectionsSize()

clientButton.MouseButton1Click:Connect(function()
    clientSelectionFrame.Visible = not clientSelectionFrame.Visible
    clientSelectionFrame.Position = UDim2.new(0, clientButton.AbsolutePosition.X, 0, clientButton.AbsolutePosition.Y + 25)
    protectionsFrame.Visible = false
end)

protectionsButton.MouseButton1Click:Connect(function()
    protectionsFrame.Visible = not protectionsFrame.Visible
    protectionsFrame.Position = UDim2.new(0, protectionsButton.AbsolutePosition.X, 0, protectionsButton.AbsolutePosition.Y + 25)
    clientSelectionFrame.Visible = false
end)

local function executeCommand()
    local prefix = prefixBox.Text:gsub("%s+", "")
    local commandText = commandBox.Text:gsub("^%s*(.-)%s*$", "%1")

    if commandText == "" then
        statusLabel.Text = "Status: Error - No command"
        statusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        return
    end

    if prefix == "" then
        statusLabel.Text = "Status: Error - No prefix"
        statusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        return
    end

    if commandText:sub(1, 1) ~= prefix then
        commandText = prefix .. commandText
    end

    local setPrefixArgs = {
        [1] = {
            [1] = "Prefix",
            [2] = prefix
        }
    }

    local commandArgs = {
        [1] = commandText
    }

    statusLabel.Text = "Status: Executing..."
    statusLabel.TextColor3 = Color3.fromRGB(255, 255, 100)

    task.spawn(function()
        pcall(function()
            game:GetService("ReplicatedStorage"):WaitForChild(currentClient):WaitForChild("Signals"):WaitForChild("ChangeSetting"):InvokeServer(unpack(setPrefixArgs))
        end)

        task.wait(0.1)

        local success, result = pcall(function()
            game:GetService("ReplicatedStorage"):WaitForChild(currentClient):WaitForChild("Signals"):WaitForChild("RequestCommand"):InvokeServer(unpack(commandArgs))
        end)

        if success then
            statusLabel.Text = "Status: Success!"
            statusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)

            task.delay(2, function()
                statusLabel.Text = "Status: Ready"
                statusLabel.TextColor3 = Color3.new(1, 1, 1)
            end)
        else
            statusLabel.Text = "Status: Error - Failed"
            statusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        end
    end)
end

local function sendProtectionCommand(cmd)
    local prefix = prefixBox.Text:gsub("%s+", "")
    if prefix ~= "" then
        cmd = prefix .. cmd
    end
    
    local commandArgs = {[1] = cmd}
    
    pcall(function()
        game:GetService("ReplicatedStorage"):WaitForChild(currentClient):WaitForChild("Signals"):WaitForChild("RequestCommand"):InvokeServer(unpack(commandArgs))
    end)
end

task.spawn(function()
    while true do
        task.wait(0.5)
        
        for protectionName, protectionData in pairs(protections) do
            if protectionData.enabled then
                local success, condition = pcall(protectionData.check)
                if success and condition then
                    sendProtectionCommand(protectionData.command)
                    task.wait(1.5)
                end
            end
        end
    end
end)

executeBtn.MouseButton1Click:Connect(executeCommand)

commandBox.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        executeCommand()
    end
end)

prefixBox.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        commandBox:CaptureFocus()
    end
end)

executeBtn.MouseEnter:Connect(function()
    TweenService:Create(executeBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 160, 80)}):Play()
end)

executeBtn.MouseLeave:Connect(function()
    TweenService:Create(executeBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 120, 60)}):Play()
end)

clientButton.MouseEnter:Connect(function()
    TweenService:Create(clientButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 80, 140)}):Play()
end)

clientButton.MouseLeave:Connect(function()
    TweenService:Create(clientButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 120)}):Play()
end)

protectionsButton.MouseEnter:Connect(function()
    TweenService:Create(protectionsButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 80, 140)}):Play()
end)

protectionsButton.MouseLeave:Connect(function()
    TweenService:Create(protectionsButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 120)}):Play()
end)

task.spawn(function()
    local userId = Players:GetUserIdFromNameAsync("prespeshnikShashlika")
    local thumbType = Enum.ThumbnailType.HeadShot
    local thumbSize = Enum.ThumbnailSize.Size420x420
    local content, isReady = Players:GetUserThumbnailAsync(userId, thumbType, thumbSize)

    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "HD Admin Commander",
        Text = "Protection system loaded!",
        Icon = content,
        Duration = 5
    })
end)

task.spawn(function()
    while true do
        task.wait(5)

        if not screenGui or not screenGui.Parent then
            local newGui = script.Parent:FindFirstChild("HDAdminCmdBar") or screenGui:Clone()
            newGui.Parent = game:GetService("CoreGui")
            screenGui = newGui
        end
    end
end)